---
title: "BIS-15L-Project"
author: "Eva Moncada"
date: "2024-03-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Installing the necessary packages

For this segment of the presentation, I will be using smoe basic packages as well as ggplot to create the graphs and ggmap to develop the maps. 
```{r}
install.packages("RColorBrewer")
install.packages("paletteer")
install.packages("ggthemes")
install.packages("ggmap")
```

# Loading the necessary libraries

```{r}
library("ggplot2")
library("naniar")
library("tidyverse")
library("janitor")
library("RColorBrewer")
library("paletteer")
library("lubridate")
library("ggmap")
```

# Loading the Crime Dataset

```{r}
crime <- read_csv("Crime_Data_from_2020_to_Present.csv") %>%
  clean_names()
```
```{r}
glimpse(crime)
```

```{r}
names(crime)
```
The names are not clean


##Cleaning the names


# Which Age Group Commits the Most Crimes In Los Angeles County?

Presented on Slide 9 of the presentation, we will be observing which age group is shown to have commited the most crimes. Furthermore, we are interested in observing which crimes were committed the most by this age group. Lastly, the year with the most crimes may provide insight as to why the crimes may have been commited, however these are all hypothetical. 

## Determining the Most Common Age Group

```{r}
crime %>%
  group_by(vict_age) %>%
  summarise(crime_count = n()) %>%
  arrange(desc(crime_count))
```

```{r}
install.packages("patchwork")
library(dplyr)
library(ggplot2)
library(patchwork)  # Add this line

# Assuming the column name for the age is "vict_age"
cleaned_crime <- crime %>%
  na.omit(subset = c("vict_age"))

# Create age groups
cleaned_crime <- cleaned_crime %>%
  mutate(age_group = cut(vict_age, breaks = seq(0, 100, by = 10), labels = FALSE))

# Calculate crime counts by age group for each year
crime_by_age_year <- cleaned_crime %>%
  group_by(year = lubridate::year(date_occ), age_group) %>%
  summarise(crime_count = n()) %>%
  arrange(desc(crime_count))

# Identify the most common and least common age groups for each year
most_common_age_group <- crime_by_age_year %>%
  group_by(year) %>%
  slice(1) %>%
  ungroup()

least_common_age_group <- crime_by_age_year %>%
  group_by(year) %>%
  slice_tail(n = 1) %>%
  ungroup()

# Bar plots for each year
bar_plots <- lapply(unique(crime_by_age_year$year), function(current_year) {
  ggplot(subset(crime_by_age_year, year == current_year), aes(x = as.factor(age_group), y = crime_count)) +
    geom_bar(stat = "identity", fill = "skyblue", color = "black") +
    labs(title = paste("Crime Distribution by Age Group - Year", current_year),
         x = "Age Group",
         y = "Crime Count") +
    theme_minimal()
})

# Scatter plot for most common and least common age groups
scatter_plot <- ggplot(most_common_age_group, aes(x = as.factor(year), y = age_group, size = crime_count)) +
  geom_point(color = "blue") +
  labs(title = "Most Common Age Group Over Years",
       x = "Year",
       y = "Age Group",
       size = "Crime Count") +

```

##Plotting the Age Groups
```{r}
names(crime)
```

```{r, fig.width=10, fig.height=6}
crime %>%
  filter(vict_age > 14) %>%
  group_by(vict_age) %>%
  summarise(crime_count = n()) %>%
  arrange(desc(crime_count)) %>%
  ggplot(aes(x = as.factor(vict_age), y = crime_count)) +
  geom_bar(stat = "identity", fill = "lightgreen", color = "black") +
  labs(title = "Crime Counts by Age Group",
       x = "Age Group",
       y = "Crime Count") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=6))

```

```{r}
crime %>%
  filter(vict_age > 14) %>%
  mutate(age_interval = cut(vict_age, breaks = seq(20, 120, by = 10), include.lowest = TRUE)) %>%
  group_by(age_interval) %>%
  summarise(crime_count = n()) %>%
  arrange(desc(crime_count)) %>%

  # Create a bar plot with x-axis labels rotated at 45 degrees
  ggplot(aes(x = age_interval, y = crime_count, fill = age_interval)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("20-29" = "skyblue", "30-39" = "orange", "40-49" = "green", "50-59" = "purple", "60-69" = "red")) +
  labs(title = "Crime Counts by Age Group",
       x = "Age Group",
       y = "Crime Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))

```

## Observing which Crimes were Committed the Most by This Age Group

## What year was most of these crimes committed for 30 year olds? Is there a significant increase in one of the years? Why do you think that is?

```{r}
crime %>%
  filter(vict_age == 30) %>%
  mutate(year = year(mdy_hms(date_occ))) %>%
  group_by(year) %>%
  summarise(crime_count = n()) %>%
  arrange(desc(crime_count))
```

Individuals of 30 years of age have committed the most crimes in Los Angeles between 2020-2024, with 2022 being the most common. One of the reasons I wanted ot observe the year of which these crimes were committed is because I wanted to know whether COVID has made an impact on crime rates. 

Now choose: Since most crimes were committed in 2024, this is post-pandemic, thus a couple hyportheses may be that there is a lack of 

###PLotting the data

```{r}
crime %>%
  filter(vict_age == 30) %>%
  mutate(year = year(mdy_hms(date_occ))) %>%
  group_by(year) %>%
  summarise(crime_count = n()) %>%
  ggplot(aes(x = as.factor(year), y = crime_count)) +
  geom_bar(stat = "identity", fill = "violet", color = "black") +
  labs(title = "Crime Counts Over the Years",
       x = "Year",
       y = "Crime Count") +
  theme_minimal()
```

# Weaponry

One of the more interesting parts of observing crimes is analyzing the weapon of choice and what that weapon was used for. When determing the weapon of choice, connecting it to the most common crime type will allow us to deduce why that weapons was chosen. For example, in murders, are knives more common than guns? If yes, then why? Is it because it is easier to find in the common household/easier to get ahold of?

## Determining the Most Used Weapon

```{r}

```

## What Crime was This Weapon Most Associated With?

```{r}

```

In this data, we see that knives were most commonly used of all the weapon types. More interestingly, we see that knives were also most used in THIS CRIME. WHY?


